# MultiDatabase 项目结构说明

**版本**: v4.3.0 (整理版)
**日期**: 2025-11-13
**作者**: Meng Linghan

---

## 📁 项目目录结构

```
MultiDatabase/
├── 📄 核心脚本 (16个Python文件)
│   ├── run_ai_workflow.py                    ⭐ AI增强工作流（推荐）
│   ├── run_complete_workflow.py              传统完整工作流
│   ├── scopus_to_wos_converter.py            基础格式转换器
│   ├── enhanced_converter.py                 增强转换器（含WOS标准化）
│   ├── enhanced_converter_batch_v2.py        批量并发转换器（最快）
│   ├── wos_standardizer.py                   WOS格式标准化
│   ├── wos_standardizer_batch.py             批量WOS标准化
│   ├── gemini_config.py                      Gemini API配置
│   ├── gemini_enricher_v2.py                 AI增强器v2
│   ├── institution_enricher_v2.py            机构信息补全v2
│   ├── author_database.py                    作者数据库管理
│   ├── merge_deduplicate.py                  合并与去重
│   ├── filter_language.py                    语言筛选
│   ├── filter_by_year.py                     年份范围过滤
│   ├── clean_institutions.py                 机构名称清洗
│   └── analyze_records.py                    统计分析
│
├── 📂 config/ (配置文件目录)
│   ├── author_database.json                  作者数据库（2470+作者）
│   ├── wos_standard_cache.json               WOS标准化缓存（60国家+237期刊）
│   ├── institution_ai_cache.json             AI机构补全缓存（1185+机构）
│   ├── journal_abbrev.json                   期刊缩写映射（106个）
│   ├── country_mapping.json                  国家名称映射（61个规则）
│   ├── institution_config.json               机构识别配置
│   ├── institution_cleaning_rules_ultimate.json  终极清洗规则（推荐）
│   ├── institution_cleaning_rules_enhanced.json  增强清洗规则
│   ├── institution_cleaning_rules.json       基础清洗规则
│   ├── institution_knowledge_base.json       机构知识库
│   └── biomedical_institutions.json          生物医学机构配置
│
├── 📂 docs/ (文档目录)
│   ├── 快速使用指南.md                       ⭐ 新手入门
│   ├── 使用指南.md                           详细使用说明
│   ├── 数据准备说明.md                       数据准备步骤
│   ├── 年份过滤使用指南.md                   年份过滤功能
│   ├── 机构清洗使用指南.md                   机构清洗功能
│   ├── AI补全系统完整总结.md                 AI功能详解
│   ├── WOS标准化说明.md                      WOS标准化说明
│   └── Scopus数据质量问题分析.md             数据质量分析
│
├── 📄 README.md                              项目总体说明
├── 📄 CLAUDE.md                              开发文档（给AI使用）
├── 📄 CHANGELOG.md                           版本更新日志
└── 📄 项目结构说明.md                        本文件

```

---

## 🚀 快速开始

### 1. 环境准备

```bash
# 进入项目目录
cd /Users/menglinghan/Desktop/MultiDatabase

# 安装依赖（如果需要）
pip3 install requests
```

### 2. 一键运行AI工作流（推荐）

```bash
python3 run_ai_workflow.py \
  --data-dir "/path/to/your/data" \
  --year-range 2015-2024
```

**要求**：数据目录中需要有 `wos.txt` 和 `scopus.csv` 文件

**输出**：
- 转换后的Scopus数据
- AI补全后的数据
- 合并去重后的数据
- 语言筛选后的数据
- 机构清洗后的数据
- 年份过滤后的数据 ⭐ 推荐用于分析
- 完整统计分析报告

---

## 📋 核心功能模块

### 模块1：格式转换与标准化

- **scopus_to_wos_converter.py**: 基础Scopus→WOS格式转换
- **enhanced_converter.py**: 增强转换器（集成WOS标准化）
- **enhanced_converter_batch_v2.py**: 批量并发转换器（20线程，3分钟完成660条）
- **wos_standardizer.py**: WOS格式标准化（国家名、期刊名）
- **wos_standardizer_batch.py**: 批量WOS标准化

**用途**: 将Scopus CSV数据转换为WOS纯文本格式，便于VOSviewer/CiteSpace分析

### 模块2：AI智能补全

- **gemini_config.py**: Gemini API配置管理
- **gemini_enricher_v2.py**: AI增强引擎v2.0
- **institution_enricher_v2.py**: 机构信息智能补全v2.0

**功能**:
- 自动补全机构的州/省代码
- 自动补全邮政编码
- 补全部门信息
- WOS标准化缩写
- 数据库缓存（95%+命中率）

### 模块3：数据整合

- **merge_deduplicate.py**: 合并WOS与Scopus数据，智能去重
- **author_database.py**: 作者数据库管理（2470+作者）

**去重策略**:
1. DOI匹配（100%准确）
2. 标题+年份+第一作者匹配（95%+准确）

### 模块4：数据筛选

- **filter_language.py**: 按语言筛选（如：只保留英文文献）
- **filter_by_year.py**: 按年份范围筛选（如：2015-2024）

**应用场景**:
- 国际期刊投稿：只分析英文文献
- 时间范围限定：移除Early Access文章

### 模块5：数据清洗与分析

- **clean_institutions.py**: 机构名称智能清洗与标准化
- **analyze_records.py**: 文献统计分析

**清洗功能**:
- 合并父子机构
- 移除独立部门
- 统一命名格式
- 移除噪音数据

**分析维度**:
- 年份分布
- 国家/地区分布
- 机构产出排名
- 作者产出排名
- 国际合作网络

### 模块6：自动化工作流

- **run_ai_workflow.py**: AI增强完整工作流 ⭐ 推荐
- **run_complete_workflow.py**: 传统完整工作流

**工作流步骤**:
1. Scopus格式转换 + WOS标准化
2. AI智能补全机构信息
3. 合并与去重
4. 语言筛选
5. 机构名称清洗
6. 统计分析
7. 年份范围过滤
8. 重新统计分析

---

## 📊 配置文件说明

### 核心配置

| 文件名 | 用途 | 大小 | 更新方式 |
|--------|------|------|----------|
| `wos_standard_cache.json` | WOS标准化缓存 | 60国家+237期刊 | AI自动学习 |
| `institution_ai_cache.json` | AI机构补全缓存 | 1185+机构 | AI自动积累 |
| `author_database.json` | 作者数据库 | 2470+作者 | 自动更新 |
| `journal_abbrev.json` | 期刊缩写映射 | 106个 | 手动添加 |
| `country_mapping.json` | 国家名称映射 | 61个规则 | 手动配置 |

### 机构清洗配置

| 文件名 | 清洗强度 | 推荐场景 |
|--------|----------|----------|
| `institution_cleaning_rules_ultimate.json` | 终极清洗 | ⭐ 默认使用 |
| `institution_cleaning_rules_enhanced.json` | 增强清洗 | 需要保留更多细节 |
| `institution_cleaning_rules.json` | 基础清洗 | 保守清洗 |

---

## 💡 使用建议

### 新用户

1. **阅读**：`docs/快速使用指南.md`
2. **准备数据**：按照 `docs/数据准备说明.md` 准备WOS和Scopus文件
3. **运行工作流**：
   ```bash
   python3 run_ai_workflow.py --data-dir "/path/to/data" --year-range 2015-2024
   ```
4. **查看结果**：检查生成的 `Final_Version_Year_Filtered.txt` 和分析报告

### 进阶用户

- **自定义期刊缩写**：编辑 `config/journal_abbrev.json`
- **调整清洗规则**：编辑 `config/institution_cleaning_rules_ultimate.json`
- **配置国家映射**：编辑 `config/country_mapping.json`
- **单独运行模块**：参考各模块的 `--help` 选项

---

## 📈 性能指标

### 处理速度

| 模块 | 数据量 | 耗时 | 性能 |
|------|--------|------|------|
| 批量转换 | 660条 | 3分钟 | 20线程并发 |
| AI补全（首次） | 660条 | ~10分钟 | 95.7%成功率 |
| AI补全（缓存） | 660条 | <1秒 | 100%命中率 |
| 合并去重 | 667条 | <1秒 | - |
| 机构清洗 | 2046机构 | <1秒 | 5.6%减少率 |
| 年份过滤 | 660→343条 | <1秒 | 48%过滤率 |

### 数据质量

| 指标 | 优化前 | 优化后 |
|------|--------|--------|
| 作者名准确率 | 81.8% | ~100% |
| 国家名准确率 | 50% | 95%+ |
| 机构信息完整度 | 60% | 95%+ |
| 整体质量评分 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

---

## 🔄 版本信息

**当前版本**: v4.3.0

**主要更新**:
- ✅ v4.3.0: 年份范围过滤功能
- ✅ v4.2.0: 作者数据库系统
- ✅ v4.1.0: 数据可视化功能
- ✅ v4.0.1: 批量并发优化（20-30x速度提升）
- ✅ v3.2.0: WOS格式标准化 + AI机构补全v2.0
- ✅ v2.1.0: 配置系统外部化

详细更新日志请查看 `CHANGELOG.md`

---

## 🆘 常见问题

### Q1: 文件放在哪里？

**答**: 将WOS和Scopus数据文件放在同一个目录下，运行时指定该目录路径即可。

### Q2: 如何处理中文文献？

**答**: 使用 `--language Chinese` 参数：
```bash
python3 run_ai_workflow.py --data-dir "/path" --language Chinese
```

### Q3: 年份过滤什么时候使用？

**答**:
- **必须使用**：论文明确声明年份范围（如"2015-2024年文献"）
- **推荐使用**：移除Early Access文章（2025-2026年）

### Q4: AI补全费用如何？

**答**:
- 首次运行：约¥0.14/1000篇
- 后续运行：¥0（使用缓存）
- 成本极低，性价比极高

---

## 📞 技术支持

- **文档中心**: 查看 `docs/` 目录下的详细指南
- **开发文档**: `CLAUDE.md` （面向开发者）
- **更新日志**: `CHANGELOG.md`
- **问题反馈**: 联系作者或提交Issue

---

**最后更新**: 2025-11-13
