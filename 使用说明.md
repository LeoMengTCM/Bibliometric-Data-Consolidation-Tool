# Scopus to WOS 转换工具使用说明

## 📋 目录
1. [快速开始](#快速开始)
2. [详细步骤](#详细步骤)
3. [高级用法](#高级用法)
4. [常见问题](#常见问题)
5. [文献计量分析工具导入指南](#文献计量分析工具导入指南)

---

## 🚀 快速开始

### 1. 确认文件位置
确保您有以下文件：
- ✅ `scopus.csv` - 从Scopus导出的CSV文件
- ✅ `scopus_to_wos_converter.py` - 转换脚本

### 2. 运行转换
打开终端（Terminal），执行：

```bash
# 进入项目目录
cd path/to/scopus-wos-tools
python3 scopus_to_wos_converter.py
```

### 3. 获取结果
转换完成后，您将得到：
- ✅ `scopus_converted_to_wos.txt` - 转换后的WOS格式文件

**就这么简单！** 🎉

---

## 📝 详细步骤

### 第一步：从Scopus导出数据

1. 在Scopus数据库中完成检索
2. 选择要导出的文献
3. 点击"Export"
4. 选择格式：**CSV**
5. 选择字段：**所有字段** (All fields)
6. 下载文件

⚠️ **重要**：确保导出时选择了以下字段：
- Authors
- Author full names
- Title
- Abstract
- Author Keywords
- References
- Affiliations
- 其他所有可选字段

### 第二步：准备转换脚本

确保您的计算机已安装Python 3：

```bash
python3 --version
```

如果显示版本号（如 `Python 3.9.x`），说明已安装。

### 第三步：执行转换

#### 方法1：使用默认路径
```bash
python3 scopus_to_wos_converter.py
```

这将读取：`scopus.csv`（当前目录）
输出到：`scopus_converted_to_wos.txt`（当前目录）

#### 方法2：自定义路径
```bash
python3 scopus_to_wos_converter.py <输入文件> <输出文件>
```

例如：
```bash
python3 scopus_to_wos_converter.py ~/Downloads/my_data.csv ~/Documents/output.txt
```

### 第四步：验证结果

转换成功后会显示：
```
✓ 转换完成！
✓ 输出文件: scopus_converted_to_wos.txt
✓ 共转换 3 条记录
```

打开输出文件，应该看到如下格式：

```
FN Scopus Export (Converted to WOS Format)
VR 1.0

PT J
AU Miceli, E
   Lenti, MV
   ...
TI Long-Term Natural History of Autoimmune Gastritis: Results from a Prospective Monocentric Series
SO AMERICAN JOURNAL OF GASTROENTEROLOGY
...
ER

PT J
...
```

---

## 🔧 高级用法

### 1. 批量转换多个文件

创建一个批处理脚本 `batch_convert.sh`：

```bash
#!/bin/bash

# 转换多个Scopus CSV文件

python3 scopus_to_wos_converter.py scopus_batch1.csv output1.txt
python3 scopus_to_wos_converter.py scopus_batch2.csv output2.txt
python3 scopus_to_wos_converter.py scopus_batch3.csv output3.txt

echo "所有文件转换完成！"
```

运行：
```bash
chmod +x batch_convert.sh
./batch_convert.sh
```

### 2. 合并多个转换后的文件

如果您有多个转换后的WOS文件需要合并：

```bash
# 合并文件（需要手动调整）
# 1. 打开第一个文件，复制所有内容
# 2. 从第二个文件复制PT到ER之间的记录
# 3. 粘贴到第一个文件的EF之前
# 4. 重复步骤2-3直到所有文件处理完
```

### 3. 修改转换参数

编辑 `scopus_to_wos_converter.py`，可以自定义：

#### 修改期刊缩写映射
找到 `JOURNAL_ABBREV` 字典（第23行左右），添加您的期刊：

```python
JOURNAL_ABBREV = {
    "Your Journal Full Name": "YOUR ABBREV",
    "American Journal of Gastroenterology": "AM J GASTROENTEROL",
    ...
}
```

#### 修改机构名缩写规则
找到 `abbreviate_institution` 函数（第434行左右），添加自定义规则：

```python
abbrev_map = {
    'Your Institution': 'Your Abbrev',
    'Department': 'Dept',
    ...
}
```

### 4. 导出转换日志

```bash
python3 scopus_to_wos_converter.py > conversion_log.txt 2>&1
```

这会将所有输出（包括错误）保存到 `conversion_log.txt`。

---

## ❓ 常见问题

### Q1: 转换失败，提示"No module named 'csv'"
**A:** 这不应该发生，csv是Python标准库。请检查Python版本：
```bash
python3 --version
```
确保是Python 3.6+。

### Q2: 某些字段为空或显示"N/A"
**A:** 这是因为Scopus原始数据中该字段为空。检查：
1. Scopus导出时是否选择了"所有字段"
2. 原始CSV文件中该字段是否有值

### Q3: 中文作者名字显示不正确
**A:** 转换脚本支持UTF-8编码，应该能正确处理中文。如果有问题：
1. 确认Scopus CSV是UTF-8编码
2. 使用文本编辑器（如VS Code）打开CSV，查看编码

### Q4: 转换后文件在CiteSpace中导入失败
**A:** 检查：
1. 文件扩展名是 `.txt`（不是 `.csv`）
2. 文件开头是 `FN Clarivate...` 或 `FN Scopus...`
3. 文件结尾是 `EF`
4. 每条记录以 `ER` 结尾

如果还是失败，尝试：
```bash
# 重新运行转换
python3 scopus_to_wos_converter.py
```

### Q5: 参考文献（CR字段）格式不对
**A:** 这是已知限制：
- Scopus参考文献格式与WOS不完全相同
- 作者首字母可能缺失
- 卷号可能不准确
- 对大多数分析影响较小

如果需要高精度引文分析，建议：
1. 使用原始WOS数据
2. 或手动校对关键参考文献

### Q6: 如何更新期刊缩写？
**A:** 编辑转换脚本的 `JOURNAL_ABBREV` 字典：

```python
JOURNAL_ABBREV = {
    "Nature": "NATURE",
    "Science": "SCIENCE",
    # 添加您的期刊
    "新期刊全称": "NEW JOURNAL ABBREV",
}
```

然后重新运行转换。

### Q7: 机构名缩写不准确怎么办？
**A:** 机构名缩写是自动生成的，可能不完美。如果需要精确的机构名，可以：
1. 编辑输出的 `.txt` 文件，手动修改C1字段
2. 或修改 `abbreviate_institution` 函数中的缩写规则

### Q8: 转换后的文件可以与真实WOS数据合并吗？
**A:** 可以！步骤：
1. 确保都是 `.txt` 格式
2. 使用DOI去重（避免重复记录）
3. 注意C1字段格式略有不同
4. 建议在文献计量工具中进行合并和去重

---

## 📊 文献计量分析工具导入指南

### CiteSpace

#### 1. 准备数据
```bash
# 转换Scopus数据
python3 scopus_to_wos_converter.py
```

#### 2. 导入CiteSpace
1. 打开CiteSpace
2. 创建新项目（New Project）
3. Data Source → 选择 "Web of Science"
4. Import → 选择转换后的 `.txt` 文件
5. 点击 "OK" 导入

#### 3. 验证导入
- 检查文献数量是否正确
- 查看作者、关键词等字段是否完整

#### 4. 开始分析
- 可以进行关键词共现、作者合作网络等分析
- C1字段格式差异对分析影响很小

---

### VOSviewer

#### 1. 准备数据
```bash
python3 scopus_to_wos_converter.py
```

#### 2. 导入VOSviewer
1. 打开VOSviewer
2. File → Create → Create a map based on bibliographic data
3. 选择 "Read data from bibliographic database files"
4. Database → 选择 "Web of Science"
5. File → 选择转换后的 `.txt` 文件
6. Next → 开始导入

#### 3. 选择分析类型
- Co-authorship（作者合作网络）
- Co-occurrence（关键词共现）
- Citation（引文网络）
- Bibliographic coupling（文献耦合）
- Co-citation（共被引）

#### 4. 注意事项
- CR字段作者首字母缺失可能影响引文网络精度
- 其他分析类型不受影响

---

### Bibliometrix (R)

#### 1. 安装Bibliometrix
```R
install.packages("bibliometrix")
library(bibliometrix)
```

#### 2. 转换数据
```bash
python3 scopus_to_wos_converter.py
```

#### 3. 导入R
```R
# 读取WOS格式文件
file <- "scopus_converted_to_wos.txt"
M <- convert2df(file, dbsource = "wos", format = "plaintext")

# 查看数据
summary(M)
```

#### 4. 分析
```R
# 描述性统计
results <- biblioAnalysis(M)
summary(results, k=10)

# 绘图
plot(results, k=10)

# 可视化
biblioshiny()  # 启动Web界面
```

---

### HistCite

#### 1. 准备数据
```bash
python3 scopus_to_wos_converter.py
```

#### 2. 导入HistCite
1. 打开HistCite
2. File → Import → Web of Science
3. 选择转换后的 `.txt` 文件
4. 开始导入

#### 3. 分析
- HistCite主要用于引文编年分析
- CR字段格式差异可能影响引文链接
- 建议验证关键引用关系

---

## 🎯 最佳实践

### 1. 数据质量控制
✅ **导出前**：
- 在Scopus中精确检索，确保结果相关性高
- 选择"所有字段"导出
- 检查记录数量

✅ **转换后**：
- 验证记录数量是否一致
- 随机抽查几条记录，检查字段完整性
- 查看转换日志，是否有警告或错误

### 2. 混合数据库分析
如果合并WOS和Scopus数据：

✅ **去重策略**：
```R
# 使用Bibliometrix去重
M_deduplicated <- mergeDbSources(M_wos, M_scopus,
                                  remove.duplicated = TRUE)
```

✅ **标记来源**：
- 在合并前给每条记录添加来源标记
- 方便后续区分和比较

### 3. 定期更新
- Scopus数据定期更新被引次数
- 建议每季度重新导出和转换
- 保持数据时效性

---

## 📞 技术支持

### 问题反馈
如果遇到问题，请提供：
1. Scopus CSV文件示例（脱敏后）
2. 错误信息截图
3. 转换日志
4. Python版本

### 文档更新
- 版本：v1.0
- 日期：2025-11-03
- 作者：Claude Code

---

## 📚 相关资源

### 文献计量学工具
- [CiteSpace官网](http://cluster.cis.drexel.edu/~cchen/citespace/)
- [VOSviewer官网](https://www.vosviewer.com/)
- [Bibliometrix官网](https://www.bibliometrix.org/)

### 数据格式参考
- [WOS格式规范](https://images.webofknowledge.com/images/help/WOS/hs_wos_fieldtags.html)
- [Scopus导出指南](https://service.elsevier.com/app/answers/detail/a_id/28268/)

### Python学习资源
- [Python官方文档](https://docs.python.org/3/)
- [CSV模块文档](https://docs.python.org/3/library/csv.html)

---

**祝您研究顺利！** 🎓📊✨
